<!doctype html>
<html lang="vi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ÄÄƒng kÃ½ trá»±c cÆ¡m â€” Báº£ng tuáº§n</title>

<style>
Â  :root{
Â  Â  --bg:#071021; --card:#0b1220; --accent:#6b46c1; --muted:#9aa4b2; --text:#e6eef6;
Â  Â  --accent2:#3b82f6; --danger:#ef4444;
Â  }
Â  *{box-sizing:border-box}
Â  body{margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Helvetica,Arial;background:linear-gradient(180deg,#061326,#081428);color:var(--text);padding:18px}
Â  header{display:flex;align-items:center;justify-content:space-between;margin-bottom:14px;gap:12px;flex-wrap:wrap}
Â  h1{margin:0;font-size:20px}
Â  .controls{display:flex;gap:8px;align-items:center}
Â  .board-wrap{overflow:auto}
Â  .board{display:grid;grid-template-columns:repeat(6, 1fr);gap:12px}
Â  .col{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:10px;padding:12px;border:1px solid rgba(255,255,255,0.03);min-height:160px}
Â  .col h3{margin:0 0 8px 0;font-size:14px;color:#cbd5e1;text-align:center}
Â  .shift{background:#071428;border-radius:8px;padding:8px;margin-bottom:10px;border:1px solid rgba(255,255,255,0.03)}
Â  .meta{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
Â  .title{font-weight:600}
Â  .progress{height:8px;background:rgba(255,255,255,0.03);border-radius:99px;overflow:hidden;margin-bottom:8px}
Â  .bar{height:100%;background:linear-gradient(90deg,var(--accent),var(--accent2));width:0%}
Â  .list{display:flex;flex-direction:column;gap:6px}
Â  .person{background:rgba(255,255,255,0.02);padding:6px;border-radius:6px;display:flex;align-items:center;gap:8px;justify-content:space-between}
Â  .avatar{width:28px;height:28px;border-radius:999px;background:#1f2937;display:flex;align-items:center;justify-content:center;color:#fff;font-weight:700}
Â  .btn{margin-top:8px;border:none;padding:8px 10px;border-radius:8px;background:var(--accent);color:white;cursor:pointer;width:100%;transition:opacity 0.3s ease}
Â  .btn[disabled]{opacity:.45;cursor:not-allowed}
Â  .delete-btn{color:var(--danger);cursor:pointer;font-weight:bold;margin-left:8px}
Â  footer{margin-top:14px;color:var(--muted);font-size:15px} /* TÄƒng chá»¯ ghi chÃº */
Â  .admin-panel{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
Â  .small{font-size:13px;color:var(--muted)}
Â  #statusBanner{padding:10px;text-align:center;border-radius:8px;margin-bottom:10px;font-weight:600}
Â  [title]{position:relative}
Â  [title]:hover::after{
Â  Â  content:attr(title);
Â  Â  position:absolute;
Â  Â  bottom:120%;
Â  Â  left:50%;
Â  Â  transform:translateX(-50%);
Â  Â  background:#111;
Â  Â  color:#fff;
Â  Â  font-size:12px;
Â  Â  padding:4px 8px;
Â  Â  border-radius:4px;
Â  Â  white-space:nowrap;
Â  Â  opacity:0.9;
Â  }
Â  @media(max-width:1100px){ .board{grid-template-columns:repeat(3, 1fr)} }
Â  @media(max-width:720px){ .board{grid-template-columns:repeat(1, 1fr)} header{flex-direction:column;align-items:flex-start} }
</style>
</head>

<body>
<header>
Â  <div>
Â  Â  <h1>ÄÄƒng kÃ½ trá»±c cÆ¡m â€” Báº£ng tuáº§n</h1>
Â  Â  <div class="small">Thá»© 2 â†’ Thá»© 7 (SÃ¡ng/Chiá»u). ThÃªm: Chiá»u Chá»§ Nháº­t. Má»—i ca tá»‘i Ä‘a 3 ngÆ°á»i.</div>
Â  </div>
Â  <div class="controls">
Â  Â  <div class="admin-panel">
Â  Â  Â  <button id="adminBtn" class="btn" style="background:transparent;border:1px solid rgba(255,255,255,0.06);padding:6px 10px">ÄÄƒng nháº­p Admin</button>
Â  Â  Â  <button id="resetBtn" class="btn" style="background:var(--danger);display:none">ğŸ”„ Reset Tuáº§n (Admin)</button>
Â  Â  Â  <button id="toggleOpenBtn" class="btn" style="background:#10b981;display:none">ğŸŸ¢ Má»Ÿ Ä‘Äƒng kÃ½ ngoÃ i giá»</button>
Â  Â  Â  <button id="logoutBtn" class="btn" style="background:#374151;display:none">ğŸšª ÄÄƒng xuáº¥t</button>
Â  Â  </div>
Â  </div>
</header>

<div id="statusBanner"></div>
<div class="board-wrap"><div id="board" class="board"></div></div>
<footer>Ghi chÃº: Báº¥m "ÄÄƒng kÃ½" â†’ nháº­p tÃªn. Báº¥m âŒ Ä‘á»ƒ xÃ³a tÃªn cá»§a chÃ­nh báº¡n. Há»‡ thá»‘ng cáº­p nháº­t realtime.</footer>

<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-database-compat.js"></script>

<script>
Â  const firebaseConfig = {
Â  Â  apiKey: "AIzaSyCZ8o7Z855RhsncCZlEt4zDe6ps-29RAq0",
Â  Â  authDomain: "lich-truc-com.firebaseapp.com",
Â  Â  databaseURL: "https://lich-truc-com-default-rtdb.firebaseio.com",
Â  Â  projectId: "lich-truc-com",
Â  Â  storageBucket: "lich-truc-com.firebasestorage.app",
Â  Â  messagingSenderId: "769659188277",
Â  Â  appId: "1:769659188277:web:da5226a15dbc0f87d46d7c"
Â  };

Â  firebase.initializeApp(firebaseConfig);
Â  const db = firebase.database();
Â  const shiftsRef = db.ref('shifts');
Â  const manualOpenRef = db.ref('manualOpen');
Â  const blacklistRef = db.ref('nameBlacklist');
Â  const adminNoteRef = db.ref('adminNote');
Â  let manualOpen = false;

Â  const days = [
Â  Â  { label: "Thá»© 2", key: "thu2" },
Â  Â  { label: "Thá»© 3", key: "thu3" },
Â  Â  { label: "Thá»© 4", key: "thu4" },
Â  Â  { label: "Thá»© 5", key: "thu5" },
Â  Â  { label: "Thá»© 6", key: "thu6" },
Â  Â  { label: "Thá»© 7", key: "thu7" },
Â  Â  { label: "Chá»§ Nháº­t", key: "cn" }
Â  ];
Â  const slotsDefault = [{ id: "ca1", title: "SÃ¡ng" }, { id: "ca2", title: "Chiá»u" }];
Â  const slotsCN = [{ id: "ca2", title: "Chiá»u" }];
Â  const MAX = 3;

Â  const board = document.getElementById('board');
Â  const resetBtn = document.getElementById('resetBtn');
Â  const adminBtn = document.getElementById('adminBtn');
Â  const logoutBtn = document.getElementById('logoutBtn');
Â  const toggleOpenBtn = document.getElementById('toggleOpenBtn');
Â  const statusBanner = document.getElementById('statusBanner');

Â  const clearNameBtn = document.createElement('button');
Â  clearNameBtn.className = 'btn';
Â  clearNameBtn.style.background = '#f59e0b';
Â  clearNameBtn.style.display = 'none';
Â  clearNameBtn.textContent = 'ğŸ§¹ XÃ³a tÃªn mÃ¡y khÃ¡ch';
Â  document.querySelector('.admin-panel').appendChild(clearNameBtn);

Â  clearNameBtn.onclick = () => {
Â  Â  const nameToRemove = prompt('Nháº­p tÃªn cáº§n xÃ³a trÃªn mÃ¡y khÃ¡ch:');
Â  Â  if (!nameToRemove) return;
Â  Â  blacklistRef.child(nameToRemove).set(true);
Â  Â  alert(`âœ… ÄÃ£ thÃªm "${nameToRemove}" vÃ o danh sÃ¡ch xoÃ¡`);
Â  };

Â  function buildGrid() {
Â  Â  board.innerHTML = '';
Â  Â  days.forEach(day => {
Â  Â  Â  const col = document.createElement('div');
Â  Â  Â  col.className = 'col';
Â  Â  Â  col.innerHTML = `<h3>${day.label}</h3>`;
Â  Â  Â  const slots = (day.key === 'cn') ? slotsCN : slotsDefault;
Â  Â  Â  slots.forEach(s => {
Â  Â  Â  Â  const shiftId = `${day.key}_${s.id}`;
Â  Â  Â  Â  col.innerHTML += `
Â  Â  Â  Â  Â  <div class="shift">
Â  Â  Â  Â  Â  Â  <div class="meta"><div class="title">${s.title}</div></div>
Â  Â  Â  Â  Â  Â  <div class="progress"><div class="bar" id="bar_${shiftId}"></div></div>
Â  Â  Â  Â  Â  Â  <div class="list" id="list_${shiftId}"></div>
Â  Â  Â  Â  Â  Â  <button class="btn" id="btn_${shiftId}" onclick="onRegister('${shiftId}')">ÄÄƒng kÃ½</button>
Â  Â  Â  Â  Â  </div>`;
Â  Â  Â  });
Â  Â  Â  board.appendChild(col);
Â  Â  });
Â  }
Â  buildGrid();

Â  shiftsRef.on('value', snap => {
Â  Â  const data = snap.val() || {};
Â  Â  days.forEach(day => {
Â  Â  Â  const slots = (day.key === 'cn') ? slotsCN : slotsDefault;
Â  Â  Â  slots.forEach(s => updateShiftUI(`${day.key}_${s.id}`, data[`${day.key}_${s.id}`] || []));
Â  Â  });
Â  });

Â  function updateShiftUI(id, arr) {
Â  Â  const listEl = document.getElementById('list_' + id);
Â  Â  const barEl = document.getElementById('bar_' + id);
Â  Â  const btnEl = document.getElementById('btn_' + id);
Â  Â  const myName = localStorage.getItem('myName');
Â  Â  listEl.innerHTML = '';
Â  Â  arr.forEach(name => {
Â  Â  Â  const p = document.createElement('div');
Â  Â  Â  p.className = 'person';
Â  Â  Â  p.innerHTML = `
Â  Â  Â  Â  <div style="display:flex;align-items:center;gap:8px">
Â  Â  Â  Â  Â  <div class="avatar">${name.slice(0,1).toUpperCase()}</div>
Â  Â  Â  Â  Â  <div>${name}</div>
Â  Â  Â  Â  </div>`;
Â  Â  Â  if (myName && myName === name) {
Â  Â  Â  Â  const del = document.createElement('span');
Â  Â  Â  Â  del.className = 'delete-btn';
Â  Â  Â  Â  del.textContent = 'âŒ';
Â  Â  Â  Â  del.onclick = () => removeSelfFromShift(id, name);
Â  Â  Â  Â  p.appendChild(del);
Â  Â  Â  }
Â  Â  Â  listEl.appendChild(p);
Â  Â  });
Â  Â  const pct = Math.min(100, (arr.length / MAX) * 100);
Â  Â  barEl.style.width = pct + '%';
Â  Â  btnEl.disabled = arr.length >= MAX;
Â  Â  btnEl.textContent = arr.length >= MAX ? 'ÄÃ£ Ä‘áº§y' : 'ÄÄƒng kÃ½';
Â  }

Â  function onRegister(shiftId) {
Â  Â  if (!isRegistrationOpen() && !sessionStorage.getItem('isAdmin')) {
Â  Â  Â  alert("ğŸ”’ NgoÃ i giá» Ä‘Äƒng kÃ½ (chá»‰ má»Ÿ 19:50 Thá»© 6 â†’ 21:00 Thá»© 7 hoáº·c admin má»Ÿ thá»§ cÃ´ng)");
Â  Â  Â  return;
Â  Â  }

Â  Â  let name = localStorage.getItem('myName');
Â  Â  if (!name) {
Â  Â  Â  name = prompt('Nháº­p tÃªn cá»§a báº¡n:');
Â  Â  Â  if (!name) return;
Â  Â  Â  name = name.trim();
Â  Â  Â  if (!name) return;
Â  Â  Â  localStorage.setItem('myName', name);
Â  Â  }
Â  Â  const ref = db.ref('shifts/' + shiftId);
Â  Â  ref.transaction(current => {
Â  Â  Â  if (!current) current = [];
Â  Â  Â  if (current.includes(name) || current.length >= MAX) return current;
Â  Â  Â  current.push(name);
Â  Â  Â  return current;
Â  Â  });
Â  }

Â  function removeSelfFromShift(shiftId, name) {
Â  Â  if (!confirm(`Báº¡n cÃ³ cháº¯c muá»‘n xÃ³a "${name}" khá»i ca nÃ y?`)) return;
Â  Â  const ref = db.ref('shifts/' + shiftId);
Â  Â  ref.transaction(current => {
Â  Â  Â  if (!current) return current;
Â  Â  Â  return current.filter(n => n !== name);
Â  Â  });
Â  }

Â  const ADMIN_PASSWORD = "Anbinh123";
Â  function setAdminMode(on) {
Â  Â  if (on) {
Â  Â  Â  resetBtn.style.display = 'inline-block';
Â  Â  Â  logoutBtn.style.display = 'inline-block';
Â  Â  Â  adminBtn.style.display = 'none';
Â  Â  Â  toggleOpenBtn.style.display = 'inline-block';
Â  Â  Â  clearNameBtn.style.display = 'inline-block';
Â  Â  Â  sessionStorage.setItem('isAdmin', 'true');
Â  Â  Â  // kiá»ƒm tra an toÃ n: adminNoteInput cÃ³ thá»ƒ Ä‘Æ°á»£c khai bÃ¡o sau (trong tháº» script khÃ¡c)
Â  Â  Â  if (typeof adminNoteInput !== 'undefined') {
Â  Â  Â  Â  adminNoteInput.style.display = noteVisible ? "block" : "none";
Â  Â  Â  }
Â  Â  } else {
Â  Â  Â  resetBtn.style.display = 'none';
Â  Â  Â  logoutBtn.style.display = 'none';
Â  Â  Â  adminBtn.style.display = 'inline-block';
Â  Â  Â  toggleOpenBtn.style.display = 'none';
Â  Â  Â  clearNameBtn.style.display = 'none';
Â  Â  Â  sessionStorage.removeItem('isAdmin');
Â  Â  Â  if (typeof adminNoteInput !== 'undefined') {
Â  Â  Â  Â  adminNoteInput.style.display = "none";
Â  Â  Â  }
Â  Â  }
Â  }

Â  adminBtn.onclick = () => {
Â  Â  const pass = prompt('Nháº­p máº­t kháº©u Admin:');
Â  Â  if (pass === ADMIN_PASSWORD) {
Â  Â  Â  alert('âœ… ÄÃ£ Ä‘Äƒng nháº­p Admin');
Â  Â  Â  setAdminMode(true);
Â  Â  } else alert('âŒ Sai máº­t kháº©u');
Â  };
Â  logoutBtn.onclick = () => { alert('ğŸšª ÄÃ£ Ä‘Äƒng xuáº¥t'); setAdminMode(false); };
Â  resetBtn.onclick = () => {
Â  Â  if (!confirm('Reset toÃ n bá»™ lá»‹ch tuáº§n?')) return;
Â  Â  const updates = {};
Â  Â  days.forEach(day => {
Â  Â  Â  const slots = (day.key === 'cn') ? slotsCN : slotsDefault;
Â  Â  Â  slots.forEach(s => updates[`${day.key}_${s.id}`] = []);
Â  Â  });
Â  Â  shiftsRef.set(updates);
Â  };
Â  if (sessionStorage.getItem('isAdmin') === 'true') setAdminMode(true);

Â  toggleOpenBtn.onclick = () => {
Â  Â  manualOpen = !manualOpen;
Â  Â  manualOpenRef.set(manualOpen);
Â  Â  toggleOpenBtn.textContent = manualOpen ? "ğŸ”´ Táº¯t má»Ÿ ngoÃ i giá»" : "ğŸŸ¢ Má»Ÿ Ä‘Äƒng kÃ½ ngoÃ i giá»";
Â  Â  toggleOpenBtn.style.background = manualOpen ? "#ef4444" : "#10b981";
Â  Â  alert(manualOpen ? "âœ… ÄÃ£ báº­t Ä‘Äƒng kÃ½ ngoÃ i giá» cho má»i ngÆ°á»i" : "ğŸ”’ ÄÃ£ táº¯t Ä‘Äƒng kÃ½ ngoÃ i giá»");
Â  Â  updateButtonStates();
Â  };

Â  manualOpenRef.on('value', snap => {
Â  Â  manualOpen = !!snap.val();
Â  Â  updateButtonStates();
Â  });

Â  blacklistRef.on('value', snap => {
Â  Â  const list = snap.val() || {};
Â  Â  const myName = localStorage.getItem('myName');
Â  Â  if (myName && list[myName]) {
Â  Â  Â  alert('âš ï¸ TÃªn cÅ© cá»§a báº¡n Ä‘Ã£ bá»‹ admin xoÃ¡, vui lÃ²ng nháº­p láº¡i tÃªn má»›i.');
Â  Â  Â  localStorage.removeItem('myName');
Â  Â  }
Â  });

Â  function isRegistrationOpen() {
Â  Â  console.log("Manual Open status (Client): ", manualOpen); // DÃ’NG CODE DEBUG ÄÃƒ CHÃˆN
Â  Â  if (manualOpen) return true;
Â  Â  const now = new Date();
Â  Â  const day = now.getDay();
Â  Â  const hour = now.getHours();
Â  Â  const minute = now.getMinutes();
Â  Â  return (day === 5 && (hour > 19 || (hour === 19 && minute >= 50))) ||
Â  Â  Â  Â  Â  Â (day === 6 && (hour < 21 || (hour === 21 && minute === 0)));
Â  }

Â function updateButtonStates() {
Â  Â  const isOpen = isRegistrationOpen() || sessionStorage.getItem('isAdmin');
Â  Â  const buttons = document.querySelectorAll(".btn");

Â  Â  buttons.forEach(btn => {
Â  Â  Â  Â  // Bá» qua cÃ¡c nÃºt Admin control (reset, logout, adminBtn, toggleOpenBtn) vÃ  nÃºt 'XÃ³a tÃªn mÃ¡y khÃ¡ch'
Â  Â  Â  Â  if (["adminBtn", "resetBtn", "logoutBtn", "toggleOpenBtn", ""].includes(btn.id) || btn === clearNameBtn) {
Â  Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  }

Â  Â  Â  Â  // XÃ¡c Ä‘á»‹nh nÃºt ÄÄƒng kÃ½ (cÃ³ id báº¯t Ä‘áº§u báº±ng 'btn_')
Â  Â  Â  Â  if (btn.id.startsWith('btn_')) {
Â  Â  Â  Â  Â  Â  // KHÃ”NG thay Ä‘á»•i thuá»™c tÃ­nh .disabled á»Ÿ Ä‘Ã¢y cho nÃºt ÄÄƒng kÃ½.
Â  Â  Â  Â  Â  Â  // Viá»‡c cháº·n Ä‘Äƒng kÃ½ sáº½ Ä‘Æ°á»£c xá»­ lÃ½ báº±ng Alert trong hÃ m onRegister().
Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  // CÃ¡c nÃºt khÃ¡c (náº¿u cÃ³) váº«n disabled khi ngoÃ i giá».
Â  Â  Â  Â  Â  Â  btn.disabled = !isOpen;
Â  Â  Â  Â  }

Â  Â  Â  Â  // Thay Ä‘á»•i opacity vÃ  title cho táº¥t cáº£ nÃºt (trá»« Admin controls Ä‘Ã£ return)
Â  Â  Â  Â  btn.style.opacity = isOpen ? "1" : "0.45";
Â  Â  Â  Â  btn.title = isOpen ? "" : "NgoÃ i giá» Ä‘Äƒng kÃ½";
Â  Â  });
Â  Â  
Â  Â  // Cáº­p nháº­t tráº¡ng thÃ¡i banner
Â  Â  if (isOpen) {
Â  Â  Â  statusBanner.style.background = "rgba(16,185,129,0.15)";
Â  Â  Â  statusBanner.style.color = "#10b981";
Â  Â  Â  statusBanner.textContent = manualOpen ? "ğŸŸ¢ ÄÄƒng kÃ½ Ä‘ang má»Ÿ (Admin báº­t thá»§ cÃ´ng)" : "ğŸŸ¢ Äang trong thá»i gian Ä‘Äƒng kÃ½";
Â  Â  } else {
Â  Â  Â  statusBanner.style.background = "rgba(239,68,68,0.15)";
Â  Â  Â  statusBanner.style.color = "#ef4444";
Â  Â  Â  statusBanner.textContent = "ğŸ”’ NgoÃ i giá» Ä‘Äƒng kÃ½ (sáº½ má»Ÿ 19:50 Thá»© 6)";
Â  Â  }
Â  }
Â  updateButtonStates();
Â  setInterval(updateButtonStates, 60000);
</script>

<div id="adminNoteToggle">ğŸ“</div>
<div id="adminNoteBox">
Â  <textarea id="adminNoteInput" placeholder="âœï¸ Nháº­p ghi chÃº cho má»i ngÆ°á»i..."></textarea>
Â  <div id="adminNoteDisplay">ğŸ“ <span id="adminNoteText" class="placeholder">KhÃ´ng cÃ³ ghi chÃº nÃ o</span></div>
</div>

<style>
Â  #adminNoteToggle {
Â  Â  position: fixed;
Â  Â  bottom: 18px;
Â  Â  right: 18px;
Â  Â  width: 42px;
Â  Â  height: 42px;
Â  Â  background: linear-gradient(135deg, #6b46c1, #3b82f6);
Â  Â  color: white;
Â  Â  font-size: 20px;
Â  Â  display: flex;
Â  Â  align-items: center;
Â  Â  justify-content: center;
Â  Â  border-radius: 50%;
Â  Â  cursor: pointer;
Â  Â  z-index: 1100;
Â  }
Â  /* TÄƒng kÃ­ch thÆ°á»›c khung 1.5x so vá»›i ban Ä‘áº§u */
Â  #adminNoteBox {
Â  Â  position: fixed;
Â  Â  bottom: 70px;
Â  Â  right: 16px;
Â  Â  background: rgba(11,18,32,0.97);
Â  Â  border: 1px solid rgba(255,255,255,0.06);
Â  Â  border-radius: 12px;
Â  Â  padding: 15px; /* tÄƒng padding */
Â  Â  width: 450px; /* tá»« 300px -> 450px */
Â  Â  max-height: 300px; /* tá»« 200px -> 300px */
Â  Â  overflow-y: auto;
Â  Â  display: none;
Â  Â  z-index: 1100;
Â  Â  font-size: 1.05em;
Â  }
Â  #adminNoteInput {
Â  Â  width: 100%;
Â  Â  min-height: 120px; /* tÄƒng chiá»u cao */
Â  Â  max-height: 250px;
Â  Â  background: rgba(255,255,255,0.05);
Â  Â  border: none;
Â  Â  color: white;
Â  Â  padding: 10px;
Â  Â  border-radius: 8px;
Â  Â  resize: vertical;
Â  Â  margin-bottom: 8px;
Â  Â  display: none;
Â  }
Â  #adminNoteDisplay { font-size: 15px; color: #d1d5db; white-space: pre-wrap; }
Â  /* placeholder má» */
Â  #adminNoteText.placeholder {
Â  Â  opacity: 0.5;
Â  Â  font-style: italic;
Â  }

Â  /* responsive nhá» mÃ n hÃ¬nh: giá»¯ há»£p lÃ½ */
Â  @media(max-width:480px){
Â  Â  #adminNoteBox { width: calc(100% - 32px); right: 16px; left: 16px; bottom: 80px; }
Â  Â  #adminNoteInput { min-height: 100px; }
Â  }
</style>

<script>
Â  const adminNoteToggle = document.getElementById("adminNoteToggle");
Â  const adminNoteBox = document.getElementById("adminNoteBox");
Â  const adminNoteInput = document.getElementById("adminNoteInput");
Â  const adminNoteText = document.getElementById("adminNoteText");
Â  let noteVisible = false;

Â  adminNoteToggle.onclick = () => {
Â  Â  noteVisible = !noteVisible;
Â  Â  adminNoteBox.style.display = noteVisible ? "block" : "none";
Â  Â  // chá»‰ hiá»‡n input náº¿u Ä‘ang lÃ  admin
Â  Â  adminNoteInput.style.display = (noteVisible && sessionStorage.getItem("isAdmin")) ? "block" : "none";
Â  };

Â  // Hiá»ƒn thá»‹ ghi chÃº vá»›i placeholder má» khi trá»‘ng
Â  adminNoteRef.on("value", snap => {
Â  Â  const val = snap.val() || "";
Â  Â  if (!val.trim()) {
Â  Â  Â  adminNoteText.textContent = "KhÃ´ng cÃ³ ghi chÃº nÃ o";
Â  Â  Â  adminNoteText.classList.add("placeholder");
Â  Â  } else {
Â  Â  Â  adminNoteText.textContent = val;
Â  Â  Â  adminNoteText.classList.remove("placeholder");
Â  Â  }
Â  Â  // Äá»“ng bá»™ giÃ¡ trá»‹ input (náº¿u cÃ³)
Â  Â  if (typeof adminNoteInput !== 'undefined') adminNoteInput.value = val;
Â  });

Â  // Khi admin nháº­p â†’ lÆ°u realtime vÃ  cáº­p nháº­t hiá»ƒn thá»‹
Â  adminNoteInput.addEventListener("input", () => {
Â  Â  if (!sessionStorage.getItem("isAdmin")) return;
Â  Â  const text = adminNoteInput.value;
Â  Â  // LÆ°u chÃ­nh xÃ¡c giÃ¡ trá»‹ (cho phÃ©p rá»—ng)
Â  Â  adminNoteRef.set(text.trim());
Â  Â  if (!text.trim()) {
Â  Â  Â  adminNoteText.textContent = "KhÃ´ng cÃ³ ghi chÃº nÃ o";
Â  Â  Â  adminNoteText.classList.add("placeholder");
Â  Â  } else {
Â  Â  Â  adminNoteText.classList.remove("placeholder");
Â  Â  }
Â  });
</script>

</body>
</html>
